<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Scanning Pipeline</title>
      <link rel="stylesheet" href="style.css" />
   </head>
   <body>
      <div id="loadingAll"></div>
      <div id="all">
         <div id="pipelineArea">
            <div class="mainArea" id="inputArea">
               <h2>Input</h2>

               <select id="calculationType" size="2">
                  <option value="photometric stereo" selected
                     >photometric stereo</option
                  >
                  <option value="spherical gradient">spherical gradient</option>
               </select>

               <select id="inputType" class="selectMenu" size="4">
                  <option value="render" title="render" class="icon" selected
                     >üñ•Ô∏è</option
                  >
                  <option value="test" title="test dataset" class="icon"
                     >üß™</option
                  >
                  <option
                     value="file"
                     title="file"
                     class="icon"
                     style="transform: rotate(180deg)"
                     >üì•</option
                  >
                  <option value="webcam" title="webcam" class="icon">üé•</option>
               </select>

               <div class="imageArea">
                  <div id="photometricStereoImages">
                     <img
                        id="photometricStereoImage_000"
                        title="‚Üê 0¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_045"
                        title="‚Üñ 45¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_090"
                        title="‚Üë 90¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_135"
                        title="‚Üó 135¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_180"
                        title="‚Üí 180¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_225"
                        title="‚Üò 225¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_270"
                        title="‚Üì 270¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_315"
                        title="‚Üô 315¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="photometricStereoImage_NONE"
                        title="no lights (optional)"
                        crossorigin="anonymous"
                     />
                  </div>

                  <div id="sphericalGradientImages">
                     <img
                        id="sphericalGradientImage_000"
                        title="‚Üê 0¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_090"
                        title="‚Üë 90¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_180"
                        title="‚Üí 180¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_270"
                        title="‚Üì 270¬∞ light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_ALL"
                        title="all lights"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_FRONT"
                        title="front light"
                        crossorigin="anonymous"
                     />
                     <img
                        id="sphericalGradientImage_NONE"
                        title="no lights (optional)"
                        crossorigin="anonymous"
                     />
                  </div>

                  <br />

                  <div id="webcamArea">
                     <video id="webcamPreview"></video>
                     <button id="webcamCapture">capture</button>
                  </div>

                  <div id="inputRenderArea">
                     <canvas id="inputRenderCanvas"></canvas>

                     <br />
                     <br />

                     <input
                        title="light polar angle"
                        id="renderLightPolarAngle"
                        class="userInput"
                        type="range"
                        name="renderLightPolarAngle"
                        min="1"
                        max="89"
                        value="75"
                        step="1"
                        onchange="renderLightPolarAngleOutput.value=value + '¬∞ '"
                        oninput="renderLightPolarAngleOutput.value=value + '¬∞ '"
                     />
                     <button class="chartButton" title="chart">üìà</button>
                     <output id="renderLightPolarAngleOutput"></output>
                     <label for="renderLightPolarAngle"
                        >light polar angle</label
                     >

                     <br />

                     <input
                        id="cameraDistance"
                        class="userInput"
                        type="range"
                        name="cameraDistance"
                        min="2"
                        max="8"
                        value="6"
                        step="0.5"
                        onchange="cameraDistanceOutput.value=value + ' lu '"
                        oninput="cameraDistanceOutput.value=value + ' lu '"
                     />
                     <output id="cameraDistanceOutput"></output>
                     <label for="cameraDistance">camera distance</label>

                     <br />

                     <input
                        id="lightDistance"
                        class="userInput"
                        type="range"
                        name="lightDistance"
                        min="1"
                        max="15"
                        value="6"
                        step="1"
                        onchange="lightDistanceOutput.value=value + ' lu '"
                        oninput="lightDistanceOutput.value=value + ' lu '"
                     />
                     <output id="lightDistanceOutput"></output>
                     <label for="lightDistance">light distance</label>
                  </div>
               </div>

               <input id="fileBrowse" type="file" accept="image/*" multiple />
            </div>

            <div class="mainArea" id="normalMapArea">
               <h2>Normal Mapping</h2>

               <div class="mainAreaButtonArea">
                  <button
                     id="normalMapUploadButton"
                     style="transform: translate(-100%, -150%) rotate(180deg)"
                     class="icon"
                     onclick="document.getElementById('normalMapUploadFileInput').click();"
                     >üì•</button
                  >
                  <input
                     type="file"
                     accept="image/*"
                     style="display: none"
                     id="normalMapUploadFileInput"
                  />
               </div>

               <img id="normalMapImage" title="normal mapping" />

               <br />
               <br />

               <input
                  id="normalMapResolution"
                  class="userInput"
                  type="range"
                  name="normalMapResolution"
                  min="1"
                  max="100"
                  value="50"
                  onchange="normalMapResolutionOutput.value=value + '% '"
                  oninput="normalMapResolutionOutput.value=value + '% '"
               />
               <output id="normalMapResolutionOutput"></output>
               <label for="normalMapResolution">resolution</label>

               <br />

               <input
                  id="polarAngleDeg"
                  class="userInput"
                  type="range"
                  name="polarAngleDeg"
                  min="1"
                  max="89"
                  step="1"
                  value="75"
                  onchange="polarAngleDegOutput.value=value + '¬∞ '"
                  oninput="polarAngleDegOutput.value=value + '¬∞ '"
               />
               <output id="polarAngleDegOutput"></output>
               <label for="polarAngleDeg">polar angle</label>

               <br />

               <input
                  id="maskThreshold"
                  class="userInput"
                  type="range"
                  name="maskThreshold"
                  min="0"
                  max="25"
                  value="5"
                  step="0.5"
                  onchange="maskThresholdOutput.value=value + '% '"
                  oninput="maskThresholdOutput.value=value + '% '"
               />
               <output id="maskThresholdOutput"></output>
               <label for="maskThreshold">mask threshold</label>

               <br />
               <br />

               <div id="normalMapAccuracyArea">
                  <span>accuracy: </span>
                  <span id="normalMapAccuracy">...</span>
                  <span> %</span>
               </div>

               <br />

               <img
                  id="normalMapGroundTruthImage"
                  title="normal mapping ground truth"
               />
            </div>

            <div class="mainArea" id="depthMapArea">
               <h2>Depth Mapping</h2>

               <progress max="100" id="depthMapProgress"></progress>

               <img id="depthMapImage" title="depth mapping" />

               <br />
               <br />

               <input
                  id="depthMapQuality"
                  class="userInput"
                  type="range"
                  name="depthMapQuality"
                  min="0.002"
                  step="0.001"
                  max="0.5"
                  value="0.025"
                  onchange="depthMapQualityOutput.value=value + '% '"
                  oninput="depthMapQualityOutput.value=value + '% '"
               />
               <output id="depthMapQualityOutput"></output>
               <label for="depthMapQuality">quality</label>

               <br />

               <input
                  id="depthMapPerspectiveCorrection"
                  class="userInput"
                  type="range"
                  name="depthMapPerspectiveCorrection"
                  min="-1"
                  step="0.01"
                  max="1"
                  value="0"
                  onchange="depthMapPerspectiveCorrectionOutput.value=value + ' '"
                  oninput="depthMapPerspectiveCorrectionOutput.value=value + ' '"
               />
               <!--<button class="chartButton" title="chart">üìà</button>-->
               <output id="depthMapPerspectiveCorrectionOutput"></output>
               <label for="depthMapPerspectiveCorrection"
                  >perspective correction factor</label
               >

               <br />
               <br />

               <div id="depthMapAccuracyArea">
                  <span>accuracy: </span>
                  <span id="depthMapAccuracy">...</span>
                  <span> %</span>
               </div>

               <br />

               <img
                  id="depthMapGroundTruthImage"
                  title="depth mapping ground truth"
               />
            </div>

            <div class="mainArea" id="pointCloudArea">
               <h2>Point Cloud</h2>

               <div class="mainAreaButtonArea">
                  <button id="pointCloudDownloadButton" class="icon">üì•</button>
               </div>

               <canvas
                  id="pointCloudCanvas"
                  title="point cloud"
                  style="width: 100%; height: auto"
               ></canvas>

               <br />
               <br />

               <input
                  title="depth factor"
                  id="depthFactor"
                  class="userInput"
                  type="range"
                  name="depthFactor"
                  min="0"
                  step="0.01"
                  max="1"
                  value="0.3"
                  onchange="depthFactorOutput.value=value"
                  oninput="depthFactorOutput.value=value"
               />
               <output id="depthFactorOutput"></output>
               <label for="depthFactor">depth factor</label>
            </div>
         </div>
         <div id="chartArea">
            <div id="chartButtonArea">
               <button id="chartDownloadButton">download chart data</button>
               <button id="chartPauseButton">pause charting</button>
               <button id="chartAbortButton">abort charting</button>
            </div>
            <canvas id="chartCanvas"></canvas>
         </div>
      </div>

      <script src="./lib/threejs/three.js"></script>
      <script src="./lib/threejs/OrbitControls.js"></script>
      <script src="./lib/threejs/GLTFLoader.js"></script>

      <script src="./lib/chartjs/chart.js"></script>

      <script src="./src/glsl-shader.js"></script>
      <script src="./src/normal-map-helper.js"></script>
      <script src="./src/depth-map-helper.js"></script>
      <script src="./src/point-cloud-helper.js"></script>
      <script src="./src/webcam-dataset-helper.js"></script>
      <script src="./src/virtual-input-renderer.js"></script>
      <script src="./src/bulk-chart-helper.js"></script>
      <script src="./src/dom-declarations.js"></script>

      <script src="./src/main.js"></script>

      <script>
         document.getElementById("all").style.opacity = "1";
         document.getElementById("loadingAll").style.opacity = "0";
         setTimeout(() => {
            document.getElementById("loadingAll").remove();
         }, 1000);
      </script>
   </body>
</html>
